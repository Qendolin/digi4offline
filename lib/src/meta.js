"use strict";var _xmldom=require("xmldom");Object.defineProperty(exports,"__esModule",{value:!0}),exports.MetaInfo=exports.MetaInfoParser=void 0;function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}class MetaInfoParser{static parse(a){const b="string"==typeof a?new _xmldom.DOMParser().parseFromString(a,"text/html"):a,c=Array.from(b.documentElement.getElementsByTagName("meta")),d=new MetaInfo;for(const b of c){const a=b.getAttribute("name");if(d.hasOwnProperty(a)){const c=b.getAttribute("content");d[a]=MetaInfoParser.converters[a](c)}}return d}}exports.MetaInfoParser=MetaInfoParser,_defineProperty(MetaInfoParser,"converters",{title:String,sbnr:String,publisher:String,publisherweb:String,publisheradr:String,publishertel:String,publishermail:String,pageLabels:a=>null==a?null:a.split(","),firstPage:Number});class MetaInfo{constructor(){_defineProperty(this,"title",void 0),_defineProperty(this,"sbnr",void 0),_defineProperty(this,"publisher",void 0),_defineProperty(this,"publisherweb",void 0),_defineProperty(this,"publisheradr",void 0),_defineProperty(this,"publishertel",void 0),_defineProperty(this,"publishermail",void 0),_defineProperty(this,"pageLabels",void 0),_defineProperty(this,"firstPage",void 0)}labelPage(a){if(this.pageLabels){a=(a+"").split("-")[0];const b=this.pageLabels.findIndex(b=>b==a);if(-1!=b)return b+1}else if(this.firstPage){if(a=(a+"").replace(/\/.*/g,""),a.startsWith("U")){const b=parseInt(a.substr(1));if(!isNaN(b))return b}else{const b=parseInt(a)+this.firstPage;if(!isNaN(b))return b-1}}else if("number"==typeof a||a.match(/^\d+$/g))return+a;throw new Error(`page label ${a} cannot be resolved`)}}exports.MetaInfo=MetaInfo;