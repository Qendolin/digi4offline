"use strict";var _commander=require("commander"),_read=_interopRequireDefault(require("read")),_d4o=require("./src/d4o.js");function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}_commander.program.requiredOption("-e, --email <address>","Your digi4school login email"),_commander.program.requiredOption("-b, --book <id>","The id of the book you want to download"),_commander.program.option("-o, --out <name>","Output path, can specify file or folder"),_commander.program.option("-p, --password <password>","Your digi4school login password (not recommended)"),_commander.program.option("-r, --ranges <ranges>","Page ranges, i.e.: 5-10,12,15-",a=>a.split(",").map(a=>a.split("-")).map(([a,b])=>({from:a,to:void 0===b?a:b}))),_commander.program.option("--dop <degree>","The amount of pages that can be downloaded at the same time",a=>parseInt(a),5),_commander.program.option("--pageRetries <retries>","How often a page download should be retired",a=>parseInt(a),10),_commander.program.option("--imageRetries <retries>","How often a image download should be retired",a=>parseInt(a),10),_commander.program.option("-l, --labels","Use page labels instead of indices for ranges"),_commander.program.on("--help",()=>{console.log(""),console.log("The password argument is optional. When not provided you will be prompted to input your password into the terminal. This way is recommended because you password will be hidden."),console.log(""),console.log("The book id is part of the url of an open book. (The book must be activated for your account) e.g.:"),console.log("\tfor /ebook/5432/1/index.html the id is 5432/1"),console.log("\tfor /ebook/3404/ the id is 3404")}),_commander.program.parse(process.argv);const options=_commander.program.opts();options.ranges=options.ranges||[{from:NaN,to:NaN}];let password=options.password;delete options.password,password?main(options,password).catch(a=>console.error(a)):(0,_read.default)({prompt:"Password? ",silent:!0},(a,b)=>{a||main(options,b).catch(a=>console.error(a))});async function main(a,b){const c=new _d4o.Digi4Offline(a);await c.login(a.email,b),await c.download(a.book,a.out,a.ranges)}